from helper.mnist_decode import mnist_decode_reformat
from network_v2 import Network
from tools import CrossEntropyCost

trd, vad, ted = mnist_decode_reformat()

net = Network([784, 100, 10], cost=CrossEntropyCost)
res = net.SGD(trd, 60, 10, 0.1,
        lmbda=5.0,
        eval_data=vad,
        mon_eval_accur=True,
        mon_eval_cost=True,
        mon_train_accur=True,
        mon_train_cost=True)
print("res:", res)
"""
hyper params
net = Network([784, 30, 10], cost=CrossEntropyCost)
res = net.SGD(trd, 30, 10, 0.5, lmbda=5.0)

results:
...
epoch28
...
epoch 29 training complete
cost on training data: 0.38528336385532047
accuracy on training data: 48299 / 50000
cost on evaluation data: 0.955027657742754
accuracy on evaluation data: 9602 / 10000

res: ([0.7967003896176597, 0.8583869878133998, 0.8907485169420557, 0.8943191503480243, 0.9158108550960473, 0.9050408343345712, 0.9538303888370228, 0.9349983701349764, 0.9475768725250027, 0.9420194445994439, 0.9464475898404316, 0.9469648328451211, 0.9353321640099688, 0.9481042042392638, 0.9340454501955088, 0.9410820348520061, 0.9498776166711845, 0.9636255044201065, 0.9692441111055776, 0.9465243209954826, 0.9537198855362901, 0.9285398115975427, 0.9608006293878926, 0.9622031075369499, 0.944763582016201, 0.9536562830763963, 0.966365044109976, 0.9464733461888428, 0.947743811084375, 0.955027657742754], [9382, 9467, 9504, 9553, 9553, 9604, 9551, 9571, 9576, 9583, 9599, 9599, 9611, 9607, 9625, 9614, 9607, 9590, 9579, 9616, 9595, 9654, 9597, 9610, 9636, 9608, 9583, 9636, 9621, 9602], [0.48191361396734067, 0.4553864074071906, 0.43499673442352155, 0.40942913735981895, 0.40556710359994136, 0.3845876301533804, 0.4141962824069343, 0.39439637343652956, 0.39720080151087445, 0.3945673037425754, 0.3852036623754409, 0.3876691224738623, 0.3727350049423057, 0.3847404312436339, 0.3668352366400198, 0.3680230944586553, 0.38277371449201114, 0.3964153211706856, 0.39451329696215653, 0.37508769129240827, 0.38527637795817826, 0.3645273038747965, 0.3951223592878562, 0.39195783510267, 0.3766986884995941, 0.37692873147925204, 0.38940979935335707, 0.37307821619404063, 0.36873195173672213, 0.38528336385532047], [46882, 47423, 47704, 47962, 47997, 48166, 47998, 48140, 48129, 48084, 48301, 48241, 48357, 48305, 48459, 48366, 48333, 48208, 48215, 48376, 48321, 48433, 48226, 48223, 48420, 48409, 48227, 48451, 48517, 48299])
"""

"""
hyper params
net = Network([784, 100, 10], cost=CrossEntropyCost)
res = net.SGD(trd, 60, 10, 0.1, lmbda=5.0)

results:
...
epoch58
...
epoch 59 training complete
cost on training data: 0.21000472913226598
accuracy on training data: 49705 / 50000
cost on evaluation data: 0.7684205859934612
accuracy on evaluation data: 9798 / 10000
"""
